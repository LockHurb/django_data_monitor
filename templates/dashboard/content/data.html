<main class="h-full overflow-y-auto">
  <div class="container px-6 mx-auto grid">
    <h2 class="my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200">

      <!-- START - título secundario -->
      {{ title }}
      <!-- END - título secundario -->

    </h2>

    <!-- Indicadores dinámicos -->
    <div class="grid gap-6 mb-8 md:grid-cols-2 xl:grid-cols-4">
      {% for indicador in indicadores %}
      <div class="flex flex-col items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
        <div class="mb-2 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider">{{ indicador.titulo }}</div>
        <div class="flex items-center">
          <div class="p-3 mr-4 {{ indicador.icon_color }} {{ indicador.icon_bg }} rounded-full {{ indicador.icon_dark_color }} {{ indicador.icon_dark_bg }}">
            {{ indicador.icon|safe }}
          </div>
          <div>
            <p class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
              {{ indicador.label }}
            </p>
            <p class="text-lg font-semibold text-gray-700 dark:text-gray-200">
              {{ indicador.valor }}
            </p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="grid gap-6 mb-8 md:grid-cols-2">

      <!-- BEGIN - Datos -->
      <div class="row-span-1 w-full overflow-hidden rounded-lg shadow-xs mb-6">

        <div class="w-full overflow-x-auto">
          <table class="w-full whitespace-no-wrap">
            <thead>
              <tr
                class="text-xs font-semibold tracking-wide text-left text-gray-500 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800">
                <th class="px-4 py-3">Nombre</th>
                <th class="px-4 py-3">Email</th>
                <th class="px-4 py-3">Programa</th>
                <th class="px-4 py-3">Mensaje</th>
                <th class="px-4 py-3">Fecha de envío</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y dark:divide-gray-700 dark:bg-gray-800">

              {% for fila in tabla %}
              <tr class="text-gray-700 dark:text-gray-400">
                <td class="px-4 py-3 text-sm">{{ fila.valor1|default:"Sin dato" }}</td>
                <td class="px-4 py-3 text-sm">{{ fila.valor2|default:"Sin dato" }}</td>
                <td class="px-4 py-3 text-sm">{{ fila.valor3|default:"Sin dato" }}</td>
                <td class="px-4 py-3 text-sm">{{ fila.valor4|truncatechars:50|default:"Sin mensaje" }}</td>
                <td class="px-4 py-3 text-sm">{{ fila.valor5|date:"d/m/Y H:i"|default:"Sin fecha" }}</td>
              </tr>
              {% empty %}
              <tr><td colspan="5" class="text-center">Sin datos</td></tr>
              {% endfor %}

            </tbody>
          </table>
        </div>
        <div
          class="grid px-4 py-3 text-xs font-semibold tracking-wide text-gray-500 uppercase border-t dark:border-gray-700 bg-gray-50 sm:grid-cols-9 dark:text-gray-400 dark:bg-gray-800">
          <span class="flex items-center col-span-3">
            {{ total_responses }} respuestas
          </span>
        </div>
      </div>
      <!-- END - Datos -->

      <!-- BEGIN - Gráficos -->
      <div class="row-span-1 grid gap-6 mb-8 md:grid-cols-12">
        <div class="min-w-0 p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
          <h4 class="mb-4 font-semibold text-gray-800 dark:text-gray-300">
            {{ chart_title }}
          </h4>
          <canvas id="line"></canvas>
          <script id="chart-labels" type="application/json">{{ chart_labels|safe }}</script>
          <script id="chart-datasets" type="application/json">{{ chart_datasets|safe }}</script>
          <script>
            document.addEventListener('DOMContentLoaded', function() {
              const labels = JSON.parse(document.getElementById('chart-labels').textContent);
              const datasets = JSON.parse(document.getElementById('chart-datasets').textContent);
              const lineConfig = {
                type: 'line',
                data: {
                  labels: labels,
                  datasets: datasets
                },
                options: {
                  responsive: true,
                  legend: { display: false },
                  tooltips: { mode: 'index', intersect: false },
                  hover: { mode: 'nearest', intersect: true },
                  scales: {
                    x: { display: true, scaleLabel: { display: true, labelString: 'Mes' } },
                    y: { display: true, scaleLabel: { display: true, labelString: 'Valor' } },
                  },
                },
              };
              const lineCtx = document.getElementById('line');
              if (lineCtx) {
                
                window.myLine = new Chart(lineCtx, lineConfig);
              }
            });
          </script>
        </div>
      </div>
      <!-- END - Gráficos -->

    </div>

  </div>
</main>